---
attack_technique: T1087
display_name: Account Discovery

atomic_tests:
- name: Enumerate all accounts
  uuid: de642ecf-c1bb-4fdd-82c0-f4c90aa39ded

  description: |
    Enumerate all accounts
  supported_platforms:
    - windows
  executor:
    name: command_prompt
    command: |
      net user
      net user /domain
      get-localuser
      get-localgroupmembers -group Users
      cmdkey.exe /list
      ls C:/Users
      get-childitem C:\Users\
      dir C:\Users\
      get-aduser -filter *
      get-localgroup
      net localgroup

- name: Enumerate all accounts via PowerShell
  uuid: 6856b60c-2579-4979-badd-5c7baa0d9558

  description: |
    Enumerate all accounts via PowerShell
  supported_platforms:
    - windows
  executor:
    name: powershell
    command: |
      net user
      net user /domain
      get-localuser
      get-localgroupmembers -group Users
      cmdkey.exe /list
      ls C:/Users
      get-childitem C:\Users\
      dir C:\Users\
      get-aduser -filter *
      get-localgroup
      net localgroup

- name: Enumerate logged on users
  uuid: b9fff992-0c78-4a09-a543-eb847e5023f5

  description: |
    Enumerate logged on users
  supported_platforms:
    - windows
  executor:
    name: command_prompt
    command: |
      query user

- name: Enumerate logged on users via PowerShell
  uuid: e2893713-5ee5-4f12-a45c-7b8f490d4d7d

  description: |
    Enumerate logged on users via PowerShell
  supported_platforms:
    - windows
  executor:
    name: powershell
    command: |
      query user
